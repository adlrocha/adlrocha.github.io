---
interface Props {
  title: string;
  slug: string;
  date: Date;
  tags?: string[];
  type?: 'blog' | 'til';
}

const { title, slug, date, tags = [], type = 'blog' } = Astro.props;

const formattedDate = date.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric'
});

const basePath = type === 'til' ? '/til' : '/writing';
---

<article class="post-item">
  <a href={`${basePath}/${slug}`} class="post-item__link">
    <div class="post-item__content">
      <h3 class="post-item__title">{title}</h3>
      {tags.length > 0 && (
        <div class="post-item__tags">
          {tags.slice(0, 2).map(tag => (
            <span class="post-item__tag">{tag}</span>
          ))}
        </div>
      )}
    </div>
    <time class="post-item__date" datetime={date.toISOString()}>
      {formattedDate}
    </time>
  </a>
</article>

<style>
  .post-item {
    border-bottom: 1px solid var(--color-border);
  }

  .post-item:last-child {
    border-bottom: none;
  }

  .post-item__link {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: var(--space-md);
    padding: var(--space-md) 0;
    text-decoration: none;
    color: inherit;
    transition: all var(--transition-fast);
  }

  .post-item__link:hover {
    padding-left: var(--space-sm);
  }

  .post-item__content {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    flex: 1;
    min-width: 0;
  }

  .post-item__title {
    font-size: var(--text-base);
    font-family: var(--font-sans);
    font-weight: 500;
    color: var(--color-text-primary);
    transition: color var(--transition-fast);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .post-item__link:hover .post-item__title {
    color: var(--color-accent);
  }

  .post-item__tags {
    display: flex;
    gap: var(--space-xs);
  }

  .post-item__tag {
    font-size: var(--text-xs);
    color: var(--color-text-tertiary);
    font-family: var(--font-mono);
  }

  .post-item__date {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
    font-family: var(--font-mono);
    flex-shrink: 0;
  }

  @media (max-width: 640px) {
    .post-item__link {
      flex-direction: column;
      gap: var(--space-xs);
    }

    .post-item__title {
      white-space: normal;
    }
  }
</style>
